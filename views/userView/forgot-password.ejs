<%- include("../partials/userHeader") %>

<main>
  <!-- Forgot Password Section -->
  <section
    style="
      background-image: url('/user-assets/img/bg/page-title.png');
      height: 150px;
      padding: 20px 0;
    "
  >
    <div style="max-width: 1200px; margin: 0 auto">
      <div
        style="
          display: flex;
          justify-content: center;
          align-items: center;
          text-align: center;
        "
      >
        <div>
          <h1 style="font-size: 70px; color: #333">Forgot Password</h1>
        </div>
      </div>
    </div>
  </section>
  <!-- End Forgot Password Section -->

  <!-- Forgot Password Area -->
  <section class="login-area pt-100 pb-100" style="padding-top: 10px">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 offset-lg-2">
          <div class="basic-login">
            <h3 class="text-center mb-60">Enter Your Email</h3>

            <!-- Form for email input -->
            <form id="forgotPasswordForm" method="post">
              <label for="email">Email Address <span>**</span></label>
              <input
                id="email"
                name="email"
                type="email"
                placeholder="Enter your email..."
                class="form-control"
                required
              />

              <button class="btn theme-btn-2 w-100" type="submit">
                Submit
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- Forgot Password Area End -->
</main>

<!-- JQuery and AJAX Script for Forgot Password -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const forgotPasswordForm = document.getElementById("forgotPasswordForm");

    forgotPasswordForm.addEventListener("submit", function (event) {
      event.preventDefault(); // Prevent the default form behavior

      const email = forgotPasswordForm.elements["email"].value; // Get the email

      // Send AJAX request to submit email for password reset
      fetch("/forgotPassword", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({ email }),
      })
        .then((response) => response.json())
        .then((data) => {
          console.log("data:", data);
          if (data.success) {
            Toastify({
              text: data.message,
              duration: 1000,
              close: true,
              gravity: "top",
              position: "center",
              backgroundColor: "green",
            }).showToast();
            setTimeout(() => {
              window.location.href = "/verifyPassOtp";
            }, 1000);
          } else {
            Swal.fire({
              icon: "error",
              title: "Error",
              text:
                data.message || "Failed to send email. Please try again later.",
            });
          }
        })
        .catch((error) => {
          Swal.fire({
            icon: "error",
            title: "Error",
            text: "An error occurred. Please try again later.",
          });
        });
    });
  });
</script>

<%- include("../partials/userFooter") %>
