<!DOCTYPE html>
<html class="no-js" lang="zxx">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>ArmorHead</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="manifest" />
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="/user-assets/img/logo-only.png"
    />
    <!-- Place favicon.ico in the root directory -->

    <!-- CSS here -->
    <style>
      /* Global Styles */
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f8f8f8;
      }

      /* Container Styles */
      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 15px;
      }

      /* Breadcrumb Styles */
      .breadcrumb-area {
        background: url("/user-assets/img/bg/page-title.png") center
          center/cover no-repeat;
        padding: 80px 0;
        text-align: center;
        color: #fff;
      }

      /* Form Styles */
      .basic-login {
        background-color: #fff;
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        padding: 40px;
      }

      .basic-login h3 {
        text-align: center;
        margin-bottom: 60px;
      }

      .basic-login label {
        font-weight: bold;
      }

      .basic-login input {
        width: 100%;
        padding: 10px;
        margin-bottom: 20px;
        border: 1px solid #ccc;
        border-radius: 5px;
      }

      .basic-login button {
        background-color: #ff6347;
        color: #fff;
        border: none;
        padding: 15px;
        width: 100%;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s;
      }

      .basic-login button:hover {
        background-color: #e74c3c;
      }

      .login-action {
        text-align: center;
      }

      .resend-link {
        color: #007bff;
        text-decoration: none;
      }

      .resend-link:hover {
        text-decoration: underline;
      }
      .wallet-icon {
        background-image: url("/user-assets/css/images/wallet.png");
        background-repeat: no-repeat;
        background-size: contain;
        display: inline-block;
        width: 24px;
        height: 24px;
      }
    </style>
    <link rel="stylesheet" href="/user-assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/user-assets/css/owl.carousel.min.css" />
    <link rel="stylesheet" href="/user-assets/css/animate.min.css" />
    <link rel="stylesheet" href="/user-assets/css/magnific-popup.css" />
    <link rel="stylesheet" href="/user-assets/css/fontawesome-all.min.css" />
    <link rel="stylesheet" href="/user-assets/css/flaticon.css" />
    <link rel="stylesheet" href="/user-assets/css/meanmenu.css" />
    <link rel="stylesheet" href="/user-assets/css/jquery-ui.css" />
    <link rel="stylesheet" href="/user-assets/css/meanmenu.css" />
    <link rel="stylesheet" href="/user-assets/css/slick.css" />
    <link rel="stylesheet" href="/user-assets/css/default.css" />
    <link rel="stylesheet" href="/user-assets/css/style.css" />
    <link rel="stylesheet" href="/user-assets/css/responsive.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/toastify-js/1.11.0/toastify.min.css"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/14.6.4/nouislider.min.css"
      rel="stylesheet"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css"
    />
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/toastify-js"
    ></script>
    <!-- Include SweetAlert2 for alerts -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  </head>

  <link
    rel="stylesheet"
    type="text/css"
    href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css"
  />
  <body>
    <main>
      <!-- sign-up-breadcrumb -->
      <section
        style="
          background-image: url('/user-assets/img/bg/page-title.png');
          height: 150px;
          padding: 20px 0;
        "
      >
        <div style="max-width: 1200px; margin: 0 auto">
          <div
            style="
              display: flex;
              justify-content: center;
              align-items: center;
              text-align: center;
            "
          >
            <div>
              <h1 style="font-size: 70px; color: #333">Sign Up</h1>
              <ul
                style="
                  list-style: none;
                  padding: 0;
                  display: flex;
                  justify-content: center;
                "
              >
                <li style="margin-right: 10px">
                  <a href="/" style="text-decoration: none; color: #007bff"
                    >Home</a
                  >
                </li>
                <li style="color: #666">Login</li>
              </ul>
            </div>
          </div>
        </div>
      </section>
      <!-- end-sign-up-breadcrumb -->

      <!-- login Area Strat-->
      <section class="login-area pt-100 pb-100">
        <div class="container">
          <div class="row">
            <div class="col-lg-8 offset-lg-2">
              <div class="basic-login">
                <h3 class="text-center mb-60">Signup From Here</h3>
                <form id="signupForm" autocomplete="off">
                  <label for="username">User Name <span>**</span></label>
                  <input
                    id="username"
                    name="username"
                    type="text"
                    placeholder="Enter First Name and Last Name..."
                    oninput="validateName()"
                    required
                  />
                  <span id="name-error" class="error"></span>

                  <label for="email-id">Email Address <span>**</span></label>
                  <input
                    id="email-id"
                    name="email"
                    type="email"
                    placeholder="Enter Email address..."
                    oninput="validateEmail()"
                    required
                  />
                  <span id="email-error" class="error"></span>

                  <label for="phone">Phone Number <span>**</span></label>
                  <input
                    id="phone"
                    name="phone"
                    type="text"
                    placeholder="Enter Phone number..."
                    oninput="validatePhone()"
                    required
                  />
                  <span id="phone-error" class="error"></span>

                  <label for="pass">Password <span>**</span></label>
                  <input
                    id="pass"
                    name="password"
                    type="password"
                    placeholder="Enter password..."
                    oninput="validatePassword()"
                    required
                  />
                  <span id="password-error" class="error"></span>

                  <label for="repass">Re-enter Password <span>**</span></label>
                  <input
                    id="repass"
                    name="repassword"
                    type="password"
                    placeholder="Re-enter password..."
                    oninput="validateRePassword()"
                    required
                  />
                  <span id="repassword-error" class="error"></span>
                  <label for="refer"
                    >Referral Code <span>(Optional)</span></label
                  >
                  <input
                    id="refer"
                    name="referral"
                    type="text"
                    placeholder="Enter referral code..."
                  />
                  <span id="referral-error" class="error"></span>

                  <button type="submit" class="btn theme-btn-2 w-100">
                    Register Now
                  </button>
                  <div class="or-divide"><span>or</span></div>
                  <button
                    class="btn theme-btn w-100"
                    onclick="window.location.href='/login'"
                  >
                    Login Now
                  </button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </section>
      <!-- login Area End-->

      <%- include("../partials/userFooter") %>
    </main>
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/toastify-js"
    ></script>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastify-js/1.11.0/toastify.min.js"></script>
    <script>
      function validateName() {
        var name = document.getElementById("username").value.trim();
        var nameError = document.getElementById("name-error");
        var nameRegex = /^[a-zA-Z]+(?: [a-zA-Z]+)*$/; // Allows only letters and spaces, with no consecutive spaces

        if (!name || !nameRegex.test(name)) {
          nameError.textContent =
            "Please enter a valid name (only letters and spaces).";
        } else {
          nameError.textContent = "";
        }
      }

      function validateEmail() {
        var email = document.getElementById("email-id").value.trim();
        var emailError = document.getElementById("email-error");
        var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/; // Ensures a minimum of 2 characters for the domain name

        if (!email || !emailRegex.test(email)) {
          emailError.textContent = "Please enter a valid email address.";
        } else {
          emailError.textContent = "";
        }
      }

      function validatePhone() {
        var phone = document.getElementById("phone").value.trim();
        var phoneError = document.getElementById("phone-error");
        var phoneRegex = /^\d{3}[-\s]?\d{3}[-\s]?\d{4}$/; // Allows common phone number formats

        if (!phone || !phoneRegex.test(phone)) {
          phoneError.textContent = "Please enter a valid phone number.";
        } else {
          phoneError.textContent = "";
        }
      }

      function validatePassword() {
        var password = document.getElementById("pass").value.trim();
        var username = document.getElementById("username").value.trim();
        var passwordError = document.getElementById("password-error");
        var errors = [];

        var minLength = 8; // Minimum password length
        if (!password || password.length < minLength) {
          errors.push(
            `Password must be at least ${minLength} characters long.`
          );
        }
        if (!/(?=.*\d)/.test(password)) {
          errors.push("Password must contain at least one digit.");
        }
        if (!/(?=.*[a-z])/.test(password)) {
          errors.push("Password must contain at least one lowercase letter.");
        }
        if (!/(?=.*[A-Z])/.test(password)) {
          errors.push("Password must contain at least one uppercase letter.");
        }
        if (!/(?=.*\W)/.test(password)) {
          errors.push("Password must contain at least one special character.");
        }
        if (password.includes(username)) {
          errors.push("Password should not contain your username.");
        }

        if (errors.length > 0) {
          passwordError.textContent = errors.join(" ");
        } else {
          passwordError.textContent = "";
        }
      }

      function validateRePassword() {
        var password = document.getElementById("pass").value.trim();
        var repassword = document.getElementById("repass").value.trim();
        var repasswordError = document.getElementById("repassword-error");

        if (!repassword || password !== repassword) {
          repasswordError.textContent = "Passwords do not match.";
        } else {
          repasswordError.textContent = "";
        }
      }

      // function validateReferralCode(input) {
      //   const referralError = document.getElementById("referral-error");
      //   const referralCode = input.value.trim();

      //   // Add your validation logic here
      //   // For example, you can check if the referral code is a specific format or length

      //   if (referralCode.length !== 6 || !/^[A-Z0-9]+$/.test(referralCode)) {
      //     referralError.textContent =
      //       "Invalid referral code. It should be 6 alphanumeric characters.";
      //     input.setCustomValidity("Invalid referral code");
      //   } else {
      //     referralError.textContent = "";
      //     input.setCustomValidity("");
      //   }
      // }

      $(document).ready(function () {
        $("#signupForm").on("submit", function (event) {
          event.preventDefault(); // Prevent the default form submission behavior
          // Collect form data
          var formData = $(this).serialize();

          $.ajax({
            type: "POST",
            url: "/signup",
            data: formData,
            dataType: "json",
            success: function (response) {
              // If the backend sends a success response, redirect to the OTP page
              if (response.message === "Into otp-verify") {
                Toastify({
                  text: "OTP send successful!",
                  duration: 3000,
                  gravity: "top",
                  position: "center",
                  backgroundColor: "green",
                }).showToast();

                // Redirect after a short delay
                setTimeout(() => {
                  window.location.href = "/verify-otp";
                }, 3000);
              } else if (response.message === "Failed to send OTP") {
                Toastify({
                  text: response.message,
                  duration: 3000,
                  gravity: "top",
                  position: "center",
                  backgroundColor: "green",
                }).showToast();
              } else {
                Toastify({
                  text: response.message,
                  duration: 3000,
                  gravity: "top",
                  position: "center",
                  backgroundColor: "green",
                }).showToast();
              }
            },
            error: function (xhr, status, error) {
              // Check if the error response has a message
              if (xhr.responseJSON && xhr.responseJSON.message) {
                Toastify({
                  text: xhr.responseJSON.message,
                  duration: 3000,
                  gravity: "top",
                  position: "center",
                  backgroundColor: "red",
                }).showToast();
              } else {
                console.error(xhr.responseText); // For debugging purposes
              }
            },
          });
        });
      });
    </script>

    <style>
      /* Global Styles */
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f8f8f8;
      }

      /* Container Styles */
      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 15px;
      }

      /* Forgot Password Section Styles */
      .forgot-password-area {
        padding-top: 100px;
        padding-bottom: 100px;
      }

      .basic-login {
        background-color: #fff;
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        padding: 40px;
      }

      .basic-login h3 {
        text-align: center;
        margin-bottom: 60px;
      }

      .basic-login label {
        font-weight: bold;
      }

      .basic-login input {
        width: 100%;
        padding: 10px;
        margin-bottom: 20px;
        border: 1px solid #ccc;
        border-radius: 5px;
      }

      .basic-login button {
        background-color: #ff6347;
        color: #fff;
        border: none;
        padding: 15px;
        width: 100%;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s;
      }

      .basic-login button:hover {
        background-color: #e74c3c;
      }

      /* Error Message Styles */
      .error {
        color: #e74c3c;
        font-size: 14px;
      }
    </style>
  </body>
</html>
